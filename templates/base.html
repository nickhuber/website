## vim: syntax=mako
<!DOCTYPE html>
<%! from fucko import xmlescape %>
<%! metadata = {} %>

<%def name='meta(*, property, **kwargs)'><% metadata[property] = kwargs %></%def>

<html lang="en">
<head>
    <%block name="head">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title><%block name="title">${SITE.name}</%block></title>

    <link rel="shortcut icon" href="${SITE.url}/static/favicon.ico">
    % if SITE.atom:
    <link href="${SITE.url}/${SITE.atom}" type="application/atom+xml" title="${SITE.name} Atom Feed" />
    % endif
    % if SITE.rss:
    <link href="${SITE.url}/${SITE.rss}" type="application/rss+xml" title="${SITE.name} RSS Feed" />
    % endif

    ## TODO feeds & og stuff

    <link rel="stylesheet" type="text/css" href="${SITE.url}/static/css/meme.css">
    <link rel="stylesheet" type="text/css" href="${SITE.url}/static/css/base16-gruvbox.light.css">
    <link rel="stylesheet" type="text/css" href="${SITE.url}/static/css/base16-gruvbox.dark.css" media="(prefers-color-scheme: dark)">
    <link rel="preload" as="font" type="font/woff" href="${SITE.url}/static/fonts/ibmplexsanscondensed/v8/Gg8gN4UfRSqiPg7Jn2ZI12V4DCEwkj1E4LVeHY5a67vspYY.woff2" crossorigin>
    <link rel="preload" as="font" type="font/woff" href="${SITE.url}/static/fonts/ibmplexsanscondensed/v8/Gg8iN4UfRSqiPg7Jn2ZI12V4DCEwkj1E4LVeHYas8F_olYQtEw.woff2" crossorigin>
    </%block>

    <%block name="metas">
    <%self:meta property="og:site_name" content="${SITE.name}"/>
    <%self:meta property="og:title"     content="${SITE.name}"/>
    % if SITE.description:
    <%self:meta property="og:description" content="${SITE.description}"/>
    % endif
    <%self:meta property="og:image"       content="${SITE.url}/static/${SITE.logo}"/>
    <%self:meta property="og:image:alt"   content="${SITE.logo_alt}"/>
    </%block>

    % for property, fields in metadata.items():
    %  if fields:
        <meta property="${property}" ${" ".join(f'{key}="{xmlescape(value)}"' for key, value in fields.items())}>
    %   endif
    % endfor
</head>
<body><%block name="stuff"/></body>
</html>
